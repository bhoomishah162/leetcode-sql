{"id":1308680961,"question_id":1480,"lang":"mysql","lang_name":"MySQL","time":"2Â weeks","timestamp":1720036808,"status":10,"status_display":"Accepted","runtime":"1073 ms","url":"/submissions/detail/1308680961/","is_pending":"Not Pending","title":"Movie Rating","memory":"0B","code":"# Write your MySQL query statement below\nwith cte as \n(select user_id, count(rating) as total from movierating \ngroup by user_id),\nmaxRatedMovies as\n(select max(total) as maxR from cte),\ncte1 as (select name\nfrom cte\njoin users u\non cte.user_id = u.user_id\njoin maxRatedMovies\nwhere maxR = total\norder by name asc\nlimit 1),\ncte3 as (select *\nfrom movierating\nwhere year(created_at) = '2020'\nAND month(created_at) = '02'),\ncte4 as (select m.movie_id, avg(rating) as avg_rating, title\nfrom cte3\njoin movies m\non cte3.movie_id = m.movie_id\ngroup by movie_id,title),\nmaxmovierating as \n(select max(avg_rating) as mr from cte4),\ncte5 as (select title\nfrom cte4 \njoin maxmovierating\non  cte4.avg_rating = maxmovierating.mr\norder by title asc\nlimit 1)\nselect name as results from cte1 \nunion all\nselect title as results from cte5;","compare_result":"1111111111111111111","title_slug":"movie-rating","has_notes":false,"flag_type":1}
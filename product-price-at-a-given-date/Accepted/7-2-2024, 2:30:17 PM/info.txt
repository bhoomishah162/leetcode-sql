{"id":1307558729,"question_id":1278,"lang":"mysql","lang_name":"MySQL","time":"2 weeks, 1 day","timestamp":1719955817,"status":10,"status_display":"Accepted","runtime":"722 ms","url":"/submissions/detail/1307558729/","is_pending":"Not Pending","title":"Product Price at a Given Date","memory":"0B","code":"# Write your MySQL query statement below\nwith cte_products as \n(select product_id from products group by product_id),\ncte as\n(select product_id, max(change_date) as 'cg' from products \nwhere change_date <= '2019-08-16' group by product_id),\ncte1 as \n(select p.product_id,p.new_price, p.change_date \nfrom products p \njoin  cte\non p.product_id = cte.product_id AND p.change_date = cte.cg)\nselect cte_products.product_id,\ncase when new_price is null then 10 else new_price end as 'price'\nfrom cte1 right join cte_products\non cte1.product_id = cte_products.product_id;\n","compare_result":"111111111111111","title_slug":"product-price-at-a-given-date","has_notes":false,"flag_type":1}
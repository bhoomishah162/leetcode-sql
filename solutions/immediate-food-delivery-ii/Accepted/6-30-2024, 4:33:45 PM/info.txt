{"id":1305247949,"question_id":1292,"lang":"mysql","lang_name":"MySQL","time":"2 weeks, 3 days","timestamp":1719790425,"status":10,"status_display":"Accepted","runtime":"626 ms","url":"/submissions/detail/1305247949/","is_pending":"Not Pending","title":"Immediate Food Delivery II","memory":"0B","code":"# Write your MySQL query statement below\nwith cte as\n(select customer_id, min(order_date) as 'first_order'\nfrom delivery\ngroup by customer_id),\nimmediate_deliveries as\n(select case when order_date = customer_pref_delivery_date then 1 else 0 end as 'immediate'\nfrom\ndelivery d\njoin cte c \non d.customer_id = c.customer_id AND d.order_date = c.first_order)\nselect ROUND(SUM(immediate)*100/COUNT(*),2) AS 'immediate_percentage'\nFROM immediate_deliveries;\n","compare_result":"1111111111111111111111","title_slug":"immediate-food-delivery-ii","has_notes":false,"flag_type":1}
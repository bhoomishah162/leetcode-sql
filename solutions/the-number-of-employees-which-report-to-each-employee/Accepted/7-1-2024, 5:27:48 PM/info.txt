{"id":1306423505,"question_id":1882,"lang":"mysql","lang_name":"MySQL","time":"2 weeks, 1 day","timestamp":1719880068,"status":10,"status_display":"Accepted","runtime":"573 ms","url":"/submissions/detail/1306423505/","is_pending":"Not Pending","title":"The Number of Employees Which Report to Each Employee","memory":"0B","code":"# Write your MySQL query statement below\nwith cte as\n(select reports_to, count(reports_to) as 'reports_count'\nfrom employees\nwhere reports_to is not null\ngroup by reports_to),\nal as (select reports_to, round(avg(age),0) as 'average_age'\nfrom employees\ngroup by reports_to)\nselect employee_id, name, reports_count,average_age\nfrom employees e\njoin cte\non e.employee_id = cte.reports_to\njoin al\non al.reports_to = cte.reports_to\norder by employee_id;","compare_result":"111111111111111111111111","title_slug":"the-number-of-employees-which-report-to-each-employee","has_notes":false,"flag_type":1}
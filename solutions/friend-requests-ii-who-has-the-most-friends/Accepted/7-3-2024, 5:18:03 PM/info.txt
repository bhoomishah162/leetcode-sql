{"id":1308803481,"question_id":602,"lang":"mysql","lang_name":"MySQL","time":"2Â weeks","timestamp":1720052283,"status":10,"status_display":"Accepted","runtime":"327 ms","url":"/submissions/detail/1308803481/","is_pending":"Not Pending","title":"Friend Requests II: Who Has the Most Friends","memory":"0B","code":"# Write your MySQL query statement below\nwith cte as \n(select requester_id, count(requester_id) as req_requested\nfrom requestaccepted\ngroup by requester_id),\ncte1 as (select accepter_id, count(accepter_id) as req_accepted\nfrom requestaccepted\ngroup by accepter_id ),\ncte3 as (select * from cte left join cte1\non cte.requester_id = cte1.accepter_id\nunion\nselect * from cte right join cte1\non cte.requester_id = cte1.accepter_id),\ncte4 as (select case\nwhen requester_id is not null then requester_id else accepter_id end as id,\ncase when req_requested is not null and req_accepted is not null then (req_requested + req_accepted)\nwhen req_requested is not null then req_requested\nelse req_accepted end as num\nfrom cte3),\ncte5 as (select max(num) as mnum from cte4)\nselect id, num from cte4 join cte5 on cte4.num = cte5.mnum;","compare_result":"111111111111","title_slug":"friend-requests-ii-who-has-the-most-friends","has_notes":false,"flag_type":1}
{"id":1321196098,"question_id":1523,"lang":"mysql","lang_name":"MySQL","time":"3 days, 2 hours","timestamp":1720993066,"status":10,"status_display":"Accepted","runtime":"420 ms","url":"/submissions/detail/1321196098/","is_pending":"Not Pending","title":"Capital Gain/Loss","memory":"0B","code":"# Write your MySQL query statement below\nwith cte as\n(select stock_name, operation, sum(price) as cgl\nfrom Stocks\ngroup by stock_name, operation)\nselect stock_name, sum(\n    case \n         when operation = 'Buy' then -cgl\n         when operation = 'Sell' then cgl\n    end) as capital_gain_loss\nfrom cte\ngroup by stock_name;","compare_result":"11111111111111111","title_slug":"capital-gainloss","has_notes":false,"flag_type":1}
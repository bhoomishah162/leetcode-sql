{"id":1307523730,"question_id":1278,"lang":"mysql","lang_name":"MySQL","time":"2 weeks, 1 day","timestamp":1719952164,"status":10,"status_display":"Accepted","runtime":"627 ms","url":"/submissions/detail/1307523730/","is_pending":"Not Pending","title":"Product Price at a Given Date","memory":"0B","code":"# Write your MySQL query statement below\nwith \ncte_products as \n(select product_id from products group by product_id),\ncte as\n(select product_id, max(change_date) as 'cg'\nfrom products\nwhere change_date <= '2019-08-16'\ngroup by product_id),\ncte2 as\n(select p.product_id, new_price from cte \ninner join products p\non cte.product_id = p.product_id and\ncte.cg = p.change_date)\nselect p.product_id, case when new_price is null then 10 else new_price end as price \nfrom cte2 right join cte_products p\non p.product_id = cte2.product_id;","compare_result":"111111111111111","title_slug":"product-price-at-a-given-date","has_notes":false,"flag_type":1}
{"id":1305217622,"question_id":1317,"lang":"mysql","lang_name":"MySQL","time":"2 weeks, 3 days","timestamp":1719785552,"status":10,"status_display":"Accepted","runtime":"695 ms","url":"/submissions/detail/1305217622/","is_pending":"Not Pending","title":"Monthly Transactions I","memory":"0B","code":"# Write your MySQL query statement below\nWith \napproved as (select country, sum(amount) as 'approved_total_amount',DATE_FORMAT(trans_date,'%Y-%m') AS 'month', count(amount) as 'approved_count'\nfrom transactions\nwhere state = 'approved'\ngroup by country, month),\ntotal as (select country, sum(amount) as 'trans_total_amount',DATE_FORMAT(trans_date,'%Y-%m') AS 'month', count(amount) as 'trans_count'\nfrom transactions\ngroup by country, month)\nSelect t.month,t.country,trans_count, \ncase when approved_count is null then 0 else approved_count end as 'approved_count',\ntrans_total_amount, \ncase when approved_total_amount is null then 0 else approved_total_amount end as 'approved_total_amount'\nfrom approved a\nright join total t\non a.month = t.month AND a.country <=> t.country;\n","compare_result":"1111111111111111","title_slug":"monthly-transactions-i","has_notes":false,"flag_type":1}
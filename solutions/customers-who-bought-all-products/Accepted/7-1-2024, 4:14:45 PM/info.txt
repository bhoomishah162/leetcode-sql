{"id":1306393219,"question_id":1135,"lang":"mysql","lang_name":"MySQL","time":"2 weeks, 2 days","timestamp":1719875685,"status":10,"status_display":"Accepted","runtime":"580 ms","url":"/submissions/detail/1306393219/","is_pending":"Not Pending","title":"Customers Who Bought All Products","memory":"0B","code":"# Write your MySQL query statement below\nwith\nunique_customer as\n(select customer_id, product_key\nfrom customer\ngroup by customer_id, product_key),\ncte as\n(select customer_id, count(product_key) as 'count1'\nfrom unique_customer\ngroup by customer_id),\nall_products as\n(select count(product_key) as 'count_product_key'\nfrom product),\ncs as (select customer_id, count1, count_product_key\nfrom cte cross join all_products)\nselect customer_id\nfrom cs \nwhere count1 = count_product_key;\n\n","compare_result":"111111111","title_slug":"customers-who-bought-all-products","has_notes":false,"flag_type":1}
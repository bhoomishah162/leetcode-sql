{"id":1321276863,"question_id":262,"lang":"mysql","lang_name":"MySQL","time":"2 days, 23 hours","timestamp":1721004855,"status":10,"status_display":"Accepted","runtime":"561 ms","url":"/submissions/detail/1321276863/","is_pending":"Not Pending","title":"Trips and Users","memory":"0B","code":"# Write your MySQL query statement below\nwith cte as\n(select request_at, id, sum(case when banned='Yes' then 1 else 0 end) as banned_req\nfrom trips\njoin users\non client_id = users_id or driver_id = users_id\nwhere request_at between \"2013-10-01\" and \"2013-10-03\"\ngroup by request_at, id),\ncte_req as\n(select request_at, count(*) as req_count\nfrom cte\nwhere banned_req = 0\ngroup by request_at),\ncte1 as \n(select request_at,id,\ncase \n    when status = 'completed' then 0\n    when status = 'cancelled_by_driver' or status = 'cancelled_by_client' then 1\nend as completion_status, \nsum(case when banned='Yes' then 1 else 0 end) as banned_req_can\nfrom trips\njoin users\non client_id = users_id or driver_id = users_id\ngroup by request_at, id, completion_status\n),\ncte2 as (select request_at, sum(completion_status) as cs\nfrom cte1\nwhere banned_req_can = 0\ngroup by request_at),\ncte3 as (select cte_req.request_at, req_count, cs \nfrom cte_req\njoin cte2\non cte_req.request_at = cte2.request_at)\nselect request_at as Day, round(cs/req_count, 2) as 'Cancellation Rate'\nfrom cte3;\n","compare_result":"111111111111","title_slug":"trips-and-users","has_notes":false,"flag_type":1}